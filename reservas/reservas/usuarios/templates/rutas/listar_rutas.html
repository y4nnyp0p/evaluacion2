{% extends "base.html" %}
{% block title %}Gestion de rutas{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h2 class="section-title mb-1">Rutas programadas</h2>
    <p class="section-subtitle mb-0">Administra origenes, destinos, precios y horarios de salida.</p>
  </div>
  <a href="{% url 'crear_ruta' %}" class="btn btn-primary">
    <i class="bi bi-plus-lg me-2"></i>Nueva ruta
  </a>
</div>

<form method="get" class="filter-bar">
  <div class="row g-3 align-items-center">
    <div class="col-md-6">
      <label class="form-label mb-1">Buscar por origen, destino o fecha</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-search"></i></span>
        <input type="text" class="form-control" placeholder="Ejemplo: Santiago o 2025-01-15" name="q" value="{{ consulta }}">
      </div>
    </div>
    <div class="col-md-3">
      <button class="btn btn-outline-primary w-100 mt-3 mt-md-0" type="submit">Filtrar</button>
    </div>
    <div class="col-md-3">
      <a href="{% url 'listar_rutas' %}" class="btn btn-light w-100 mt-3 mt-md-0">Limpiar</a>
    </div>
  </div>
</form>

<div class="table-card">
  <div class="table-responsive">
    <table class="table align-middle">
      <thead>
        <tr>
          <th>Origen</th>
          <th>Destino</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Precio</th>
          <th class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for ruta in rutas %}
          <tr>
            <td>{{ ruta.origen }}</td>
            <td>{{ ruta.destino }}</td>
            <td>{{ ruta.fecha|date:"d/m/Y" }}</td>
            <td>{{ ruta.hora_salida|time:"H:i" }}</td>
            <td>${{ ruta.precio }}</td>
            <td class="text-end">
              <a href="{% url 'editar_ruta' ruta.pk %}" class="btn btn-sm btn-outline-primary me-2">Editar</a>
              <a href="{% url 'eliminar_ruta' ruta.pk %}" class="btn btn-sm btn-outline-danger">Eliminar</a>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6" class="text-center text-muted py-4">
              No se encontraron rutas. Crea una nueva para comenzar.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
